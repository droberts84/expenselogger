{% extends "expenselogger/main.html" %}

{% block content %}
<h2>Submit New Expense</h2>


<form id="expenseform" action="/create/" method="post" class="form-horizontal" >
    {% csrf_token %}
    {% for field in form %}
        <div class="form_group row">
            {{ field.errors }}
            <div class="col-sm-2">
    	        {{ field.label_tag }} 
    	    </div>
    	    <div class="col-sm-10">
    	        {{ field }}
       		</div>
        </div>
    {% endfor %}
    <button type="submit" value="Submit" class="btn btn-default">Submit</button>

</form>

<!-- confirm expense submissions -->
<script>
    $( '#expenseform' ).submit(function( event ) {

        var currentForm = this;
        bootbox.confirm("Are you sure you want to submit the expense?", function( result ) {
            if( result ) {
                currentForm.submit();
            }
            
        });
        event.preventDefault();
    });
</script>


<h2>Recently Submitted Expenses</h2>

<table class="table">
    <tr>
        <!-- header row -->
        <th>Date</th>
        <th>Expense Name</th>
        <th>Type</th>
        <th>Amount</th>
    </tr>
    {% for expense in expense_list %}
        <tr>
            <td>{{ expense.date }}</td>
            <td>{{ expense.name }}</td>
            <td>{{ expense.get_expense_type_display }}</td>
            <td>{{ expense.amount|floatformat:"2" }}</td>
        </tr>
    {% endfor %}
</table>

{% endblock %}